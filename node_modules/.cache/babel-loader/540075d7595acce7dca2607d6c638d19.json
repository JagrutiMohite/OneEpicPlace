{"remainingRequest":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/babel-loader/lib/index.js!/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/src/views/3. user views/components/calendars/WeeklyViewCalendar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/src/views/3. user views/components/calendars/WeeklyViewCalendar.vue","mtime":1562358994137},{"path":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseInt from \"/Users/jagrutimohite/Documents/web page internship/OneEpicPlace/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.sort\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from '@/services/api_access';\nexport default {\n  data: function data() {\n    return {\n      //Week for the calendar\n      week: [],\n      //locations include: id, name, type\n      locations: this.$parent.locations,\n      //List of returned bookings\n      bookings: [],\n      //Interval to check the server for bookings\n      checkBookingsTimeout: null,\n      bookingDelays: 0\n    };\n  },\n  methods: {\n    /* Date Functions */\n    getWeek: function getWeek(day) {\n      this.week[0] = new Date(day.setDate(day.getDate() - day.getDay()));\n      this.week[0].setHours(0, 0, 0, 0);\n      var previous = new Date(this.week[0]);\n\n      for (var i = 1; i < 7; i++) {\n        this.week[i] = new Date(previous.setDate(this.week[i - 1].getDate() + 1));\n        this.week[i].setHours(0, 0, 0, 0);\n        previous = new Date(this.week[i]);\n      }\n    },\n    decWeek: function decWeek() {\n      this.getWeek(new Date(this.week[0].setDate(this.week[0].getDate() - 1)));\n      this.checkBookings();\n    },\n    incWeek: function incWeek() {\n      this.getWeek(new Date(this.week[this.week.length - 1].setDate(this.week[this.week.length - 1].getDate() + 1)));\n      this.checkBookings();\n    },\n\n    /* JavaScript Styling */\n    styleDeskElements: function styleDeskElements(location) {\n      if (location.type == 'room') {\n        for (var i = 0; i < this.locations.length; i++) {\n          if (this.locations[i] == location && i + 1 < this.locations.length && this.locations[i + 1].type == 'desk') return 'margin-bottom: 20px;';\n        }\n      } else if (location.type == 'desk') return 'height: 26px;';\n    },\n    styleCurrentDay: function styleCurrentDay(day) {\n      if (new Date().toJSON().slice(0, 10) == day.toJSON().slice(0, 10)) return 'background-color: Gainsboro;';else //Done to reset yestday on DOM lifecycle refresh\n        return 'background-color: white;';\n    },\n    getDayOfTheWeek: function getDayOfTheWeek(day) {\n      switch (day.getDay()) {\n        case 0:\n          return 'Sunday';\n\n        case 1:\n          return 'Monday';\n\n        case 2:\n          return 'Tuesday';\n\n        case 3:\n          return 'Wednesday';\n\n        case 4:\n          return 'Thursday';\n\n        case 5:\n          return 'Friday';\n\n        case 6:\n          return 'Saturday';\n      }\n    },\n    sortBookingsFor: function sortBookingsFor(date, location) {\n      var matchedBookings = []; //sort though all bookings and return the first 3 that are within the right block and not a desk\n\n      for (var i = 0; i < this.bookings.length; i++) {\n        if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID && location.type == 'room') matchedBookings[matchedBookings.length] = this.bookings[i];\n      }\n\n      matchedBookings.sort(function (booking1, booking2) {\n        booking1 = booking1.startTime.split(':')[0] + booking1.startTime.split(':')[1];\n        booking2 = booking2.startTime.split(':')[0] + booking2.startTime.split(':')[1]; //console.log(booking1 + '  ' + booking2);\n\n        return booking1 - booking2;\n      });\n      if (matchedBookings.length > 3) matchedBookings = [matchedBookings[0], matchedBookings[1], matchedBookings[2]];\n      return matchedBookings;\n    },\n    getBookingCount: function getBookingCount(date, location) {\n      var count = 0;\n\n      for (var i = 0; i < this.bookings.length; i++) {\n        if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID) count++;\n      }\n\n      return count;\n    },\n    styleBookingCount: function styleBookingCount(date, location) {\n      var count = 0;\n\n      for (var i = 0; i < this.bookings.length; i++) {\n        if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID) count++;\n      }\n\n      if (count == 0) return 'visibility: hidden;';\n    },\n    fillBookingStartTime: function fillBookingStartTime(booking) {\n      if (booking.startTime.split(':')[0] < 12) return _parseInt(booking.startTime.split(':')[0]) + ':' + booking.startTime.split(':')[1] + ' am';else if (booking.startTime.split(':')[0] == 12) return booking.startTime + ' pm';else return booking.startTime.split(':')[0] - 12 + ':' + booking.startTime.split(':')[1] + ' pm';\n    },\n    styleIcon: function styleIcon(booking) {\n      var volumeOn = require('../../../../assets/volumeOn-black.png');\n\n      var volumeOff = require('../../../../assets/volumeOff-black.png');\n\n      if (booking.noiseLevel > 0) return 'background-image: url(' + volumeOn + ');';else if (booking.noiseLevel < 0) return 'background-image: url(' + volumeOff + ');';\n    },\n    styleBookingText: function styleBookingText(booking) {\n      if (booking.noiseLevel != 0) return 'width: calc(98% - 90px);';\n    },\n\n    /* Data Update */\n    checkBookingsLoop: function checkBookingsLoop() {\n      var THIS = this;\n      this.checkBookingsTimeout = setTimeout(function () {\n        THIS.bookingsDelay = 5000;\n        var startDate = THIS.week[0].toJSON().slice(0, 10);\n        var endDate = THIS.week[THIS.week.length - 1].toJSON().slice(0, 10);\n        var refDate = THIS.week[0];\n        api.getBookingsDate(startDate, endDate).then(function (bookingsResult) {\n          if (refDate != THIS.week[0]) return;\n          THIS.bookings = bookingsResult;\n          THIS.checkBookingsLoop();\n        });\n      }, this.bookingsDelay);\n    },\n    checkBookings: function checkBookings() {\n      this.bookings = [];\n      clearTimeout(this.checkBookingsTimeout);\n      this.bookingsDelay = 0;\n      this.checkBookingsLoop();\n    },\n\n    /* User Actions */\n    handlePageScroll: function handlePageScroll() {\n      //Top Row Sticky Movment\n      var originalTop = document.getElementById('calendar').getBoundingClientRect().top + window.scrollY;\n      if (window.scrollY >= originalTop) document.getElementById('topRow').style.top = window.scrollY - originalTop + 'px';else document.getElementById('topRow').style.top = '0px';\n    },\n    handleInnerSectionScroll: function handleInnerSectionScroll() {\n      //Make sure calender y cant be changed\n      document.getElementById('innerSection').scrollTop = 0;\n    },\n    addBookingClicked: function addBookingClicked(date, location) {\n      this.$parent.closeModals();\n      this.$parent.$refs.BookingModal.openModal(date, location, '12:00', '12:00');\n    },\n    viewBookings: function viewBookings(date, location) {\n      var matchedBookings = []; //sort though all bookings and return the first 3 that are within the right day\n\n      for (var i = 0; i < this.bookings.length; i++) {\n        if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID) matchedBookings[matchedBookings.length] = this.bookings[i];\n      }\n\n      matchedBookings.sort(function (booking1, booking2) {\n        booking1 = booking1.startTime.split(':')[0] + booking1.startTime.split(':')[1];\n        booking2 = booking2.startTime.split(':')[0] + booking2.startTime.split(':')[1]; //console.log(booking1 + '  ' + booking2);\n\n        return booking1 - booking2;\n      });\n      this.$parent.closeModals();\n      this.$parent.$refs.BookedDayModal.openModal(matchedBookings);\n    }\n  },\n  beforeMount: function beforeMount() {\n    //console.log('beforeMount');\n    this.getWeek(new Date());\n  },\n  mounted: function mounted() {\n    //console.log('mounted');\n    //Start check booking loop\n    this.checkBookingsLoop(); //Start page scroll listener\n\n    window.addEventListener('scroll', this.handlePageScroll);\n  },\n  beforeDestroy: function beforeDestroy() {\n    //console.log('beforeDestroy');\n    //End check booking loop\n    clearTimeout(this.checkBookingsTimeout); //End page scroll listener\n\n    window.removeEventListener('scroll', this.handlePageScroll);\n  }\n};",{"version":3,"sources":["WeeklyViewCalendar.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"WeeklyViewCalendar\"> \n\n        <!-- Container for date selector -->\n        <div class=\"dateSelector\">\n            <button id=\"dateSelectorPreviousBtn\" class=\"btn backBtn\" type=\"button\" @click=\"decWeek()\"></button>\n            <input id=\"dateSelectorDate\" class=\"date\" :value=\"week[0].getMonth()+1+'/'+week[0].getDate()+'/'+week[0].getFullYear()\" disabled>\n            <div class=\"hyphen\">-</div>\n            <input id=\"dateSelectorDate\" class=\"date\" :value=\"week[6].getMonth()+1+'/'+week[6].getDate()+'/'+week[6].getFullYear()\" disabled>\n            <!--button id=\"dateSelectorCalendar\" class=\"btn calendarBtn\" type=\"button\"></button-->\n            <button id=\"dateSelectorPreviousBtn\" class=\"btn forwardBtn\" type=\"button\" @click=\"incWeek()\"></button>\n        </div>\n\n        <!-- Calendar -->\n        <div class=\"calendar\" id='calendar'>\n\n            <!-- Locations -->\n            <div class=\"locationCol\">\n                <div class=\"firstLocationPlaceHolder\"></div>\n                <div class=\"locationContainer\" v-for=\"location in locations\" :key=\"'location'+location.id\" :id=\"'location'+location.id\" :style='styleDeskElements(location)'>\n                    <div class=\"location\">\n                        <div class=\"text\">{{location.name}}</div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Inner Scrollable Section -->\n            <div class=\"innerSection\" id='innerSection' @scroll='handleInnerSectionScroll()'>\n                \n                <!-- Days -->\n                <div class=\"topRow\" id='topRow'>\n                    <div class=\"dayContainer\" v-for=\"(day, index) in week\" :key=\"'day'+index\">\n                        <div class=\"day\">\n                            <div class=\"date\">{{day.getMonth()+1 + ' / ' + day.getDate()}}</div>\n                            <div class=\"dayOfTheWeek\">{{getDayOfTheWeek(day)}}</div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Calendar Rows -->\n                <div class=\"firstRowPlaceHolder\"></div>\n                <div class=\"calendarRow\" v-for=\"location in locations\" :key=\"'loc'+location.id\" :style='styleDeskElements(location)'>\n                    <!-- Calendar Blocks -->\n                    <div class=\"block\" v-for=\"(day, index) in week\" :key=\"'block'+location.id+':'+index\" :style='styleCurrentDay(day)'>\n                        \n                        <!-- Buttons -->\n                        <div class=\"searchIcon\" :style='styleBookingCount(day, location)' @click='viewBookings(day, location)'></div>\n                        <div class=\"searchText\" :style='styleBookingCount(day, location)' @click='viewBookings(day, location)'>\n                            {{getBookingCount(day, location) + ' total'}}\n                        </div>\n                        <button class=\"addBtn\" @click=\"addBookingClicked(day, location)\"></button>\n                        \n                        <!-- Bookings -->\n                        <div class=\"booking\" v-for=\"booking in sortBookingsFor(day, location)\" :key=\"'booking'+booking.id\" @click='viewBookings(day, location)'>\n                            <div class=\"timeBox\" :style='\"background-color:\"+booking.bookingColor'>\n                                <div class=\"time\">{{fillBookingStartTime(booking)}}</div>\n                            </div>\n                            <div v-if='booking.noiseLevel != 0' class=\"icon\" :style='styleIcon(booking)'></div>\n                            <div class=\"textBox\" :style='styleBookingText(booking)'>\n                                <div class=\"text\">{{booking.title}}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style scoped lang=\"scss\">\n    //Personal CSS\n    @import \"./css/WeeklyViewCalendar.css\";\n</style>\n\n<script>\n    import * as api from '@/services/api_access';\n\n    export default {\n        data() {\n            return {\n                //Week for the calendar\n                week: [],\n\n                //locations include: id, name, type\n                locations: this.$parent.locations,\n\n                //List of returned bookings\n                bookings: [],\n                //Interval to check the server for bookings\n                checkBookingsTimeout: null,\n                bookingDelays: 0,\n            }\n        },\n\n        methods: {\n            /* Date Functions */\n            getWeek(day) {\n                this.week[0] = new Date(day.setDate(day.getDate() - (day.getDay())));\n                this.week[0].setHours(0, 0, 0, 0);\n                var previous = new Date(this.week[0]);\n                for (var i = 1; i < 7; i++) {\n                    this.week[i] = new Date(previous.setDate(this.week[i-1].getDate() + 1));\n                    this.week[i].setHours(0, 0, 0, 0);\n                    previous = new Date(this.week[i]);\n                }\n            },\n            decWeek: function() {\n                this.getWeek(new Date(this.week[0].setDate(this.week[0].getDate() - 1)));\n                this.checkBookings();\n            },\n            incWeek: function() {\n                this.getWeek(new Date(this.week[this.week.length-1].setDate(this.week[this.week.length-1].getDate() + 1)));\n                this.checkBookings();\n            },\n\n            /* JavaScript Styling */\n            styleDeskElements(location) {\n                if (location.type == 'room') {\n                    for (var i = 0; i < this.locations.length; i++) {\n                        if (this.locations[i] == location && i+1 < this.locations.length && this.locations[i+1].type == 'desk')\n                            return 'margin-bottom: 20px;';\n                    }\n                }\n                else if (location.type == 'desk')\n                    return 'height: 26px;';\n            },\n            styleCurrentDay(day) {\n                if (new Date().toJSON().slice(0, 10) == day.toJSON().slice(0, 10))\n                    return 'background-color: Gainsboro;';\n                else    //Done to reset yestday on DOM lifecycle refresh\n                    return 'background-color: white;';\n            },\n            getDayOfTheWeek(day) {\n                switch(day.getDay()) {\n                    case 0: return 'Sunday';\n                    case 1: return 'Monday';\n                    case 2: return 'Tuesday';\n                    case 3: return 'Wednesday';\n                    case 4: return 'Thursday';\n                    case 5: return 'Friday';\n                    case 6: return 'Saturday';\n                }\n            },\n            sortBookingsFor(date, location) {\n                var matchedBookings = [];\n                //sort though all bookings and return the first 3 that are within the right block and not a desk\n                for (var i = 0; i < this.bookings.length; i++) {\n                    if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID && location.type == 'room')\n                        matchedBookings[matchedBookings.length] = this.bookings[i];\n                }\n                matchedBookings.sort(function(booking1, booking2) {\n                    booking1 = booking1.startTime.split(':')[0] + booking1.startTime.split(':')[1];\n                    booking2 = booking2.startTime.split(':')[0] + booking2.startTime.split(':')[1];\n                    //console.log(booking1 + '  ' + booking2);\n                    return booking1 - booking2;\n                });\n                if (matchedBookings.length > 3) \n                    matchedBookings = [matchedBookings[0], matchedBookings[1], matchedBookings[2]];\n                return matchedBookings;\n            },\n            getBookingCount(date, location) {\n                var count = 0;\n                for (var i = 0; i < this.bookings.length; i++) {\n                    if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID)\n                        count++;\n                }\n                return count;\n            },\n            styleBookingCount(date, location) {\n                var count = 0;\n                for (var i = 0; i < this.bookings.length; i++) {\n                    if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID)\n                        count++;\n                }\n                if (count == 0)\n                    return 'visibility: hidden;';\n            },\n            fillBookingStartTime(booking) {\n                if (booking.startTime.split(':')[0] < 12)\n                    return parseInt(booking.startTime.split(':')[0]) + ':' + booking.startTime.split(':')[1] + ' am';\n                else if (booking.startTime.split(':')[0] == 12)\n                    return booking.startTime + ' pm';\n                else\n                    return booking.startTime.split(':')[0] - 12 + ':' + booking.startTime.split(':')[1] + ' pm';\n            },\n            styleIcon(booking) {\n                var volumeOn = require('../../../../assets/volumeOn-black.png');\n                var volumeOff = require('../../../../assets/volumeOff-black.png');\n                if (booking.noiseLevel > 0)\n                    return 'background-image: url('+volumeOn+');';\n                else if (booking.noiseLevel < 0)\n                    return 'background-image: url('+volumeOff+');';\n            },\n            styleBookingText(booking) {\n                if (booking.noiseLevel != 0)\n                    return 'width: calc(98% - 90px);';\n            },\n\n            /* Data Update */\n            checkBookingsLoop() {\n                var THIS = this;\n                this.checkBookingsTimeout = setTimeout(function() {\n                    THIS.bookingsDelay = 5000;\n                    var startDate = THIS.week[0].toJSON().slice(0, 10);\n                    var endDate = THIS.week[THIS.week.length-1].toJSON().slice(0, 10);\n                    var refDate = THIS.week[0];\n                    api.getBookingsDate(startDate, endDate).then(bookingsResult => {\n                        if (refDate != THIS.week[0])\n                            return;\n                        THIS.bookings = bookingsResult;\n                        THIS.checkBookingsLoop();\n                    });\n                }, this.bookingsDelay)\n            },\n            checkBookings() {\n                this.bookings = [];\n                clearTimeout(this.checkBookingsTimeout);\n                this.bookingsDelay = 0;\n                this.checkBookingsLoop();\n            },\n\n            /* User Actions */\n            handlePageScroll() {\n                //Top Row Sticky Movment\n                var originalTop = document.getElementById('calendar').getBoundingClientRect().top + window.scrollY;\n                if (window.scrollY >= originalTop)\n                    document.getElementById('topRow').style.top = window.scrollY - originalTop + 'px';\n                else\n                    document.getElementById('topRow').style.top = '0px';\n            },\n            handleInnerSectionScroll() {\n                //Make sure calender y cant be changed\n                document.getElementById('innerSection').scrollTop = 0;\n            },\n\n            addBookingClicked(date, location) {\n                this.$parent.closeModals();\n                this.$parent.$refs.BookingModal.openModal(date, location, '12:00', '12:00');\n            },\n\n            viewBookings(date, location) {\n                var matchedBookings = [];\n                //sort though all bookings and return the first 3 that are within the right day\n                for (var i = 0; i < this.bookings.length; i++) {\n                    if (date.toJSON().slice(0, 10) == this.bookings[i].date.slice(0, 10) && location.id == this.bookings[i].locationID)\n                        matchedBookings[matchedBookings.length] = this.bookings[i];\n                }\n                matchedBookings.sort(function(booking1, booking2) {\n                    booking1 = booking1.startTime.split(':')[0] + booking1.startTime.split(':')[1];\n                    booking2 = booking2.startTime.split(':')[0] + booking2.startTime.split(':')[1];\n                    //console.log(booking1 + '  ' + booking2);\n                    return booking1 - booking2;\n                });\n                this.$parent.closeModals();\n                this.$parent.$refs.BookedDayModal.openModal(matchedBookings);\n            }\n        },\n        \n        beforeMount() {\n            //console.log('beforeMount');\n            this.getWeek(new Date());\n        },\n        mounted() {\n            //console.log('mounted');\n            //Start check booking loop\n            this.checkBookingsLoop();\n            //Start page scroll listener\n            window.addEventListener('scroll', this.handlePageScroll);\n        },\n        beforeDestroy() {\n            //console.log('beforeDestroy');\n            //End check booking loop\n            clearTimeout(this.checkBookingsTimeout);\n            //End page scroll listener\n            window.removeEventListener('scroll', this.handlePageScroll);\n        }\n    }\n</script>\n"],"sourceRoot":"src/views/3. user views/components/calendars"}]}